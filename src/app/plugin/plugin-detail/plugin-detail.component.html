<h1>{{plugin.name}}
  <div style="display: inline-block;">
    <p-button icon="pi pi-code"
              (click)="displayManifest()"
              pTooltip="Display JSON Manifest"
              tooltipPosition="left"
              [outlined]="true">
    </p-button>
    <p-button icon="pi pi-trash" *ngIf="canEdit()" type="button"
              pTooltip="Delete plugin"
              tooltipPosition="left"
              [outlined]="true"
              (click)="deletePlugin();">
    </p-button>
  </div>
</h1>

<p-fieldset legend="Details" [toggleable]="true">
  <div class="grid nested-grid">
    <div class="col-12 md:col-6">
      <div class="grid">
        <div class="col-3 py-1 font-semibold">Name:</div>
        <div class="col-9 py-1">{{plugin.name}}</div>

        <div class="col-3 py-1 font-semibold">Title:</div>
        <div class="col-9 py-1">{{plugin.title}}</div>

        <div class="col-3 py-1 font-semibold">Operation type:</div>
        <div class="col-9 py-1">{{plugin.operationType}}</div>

        <div class="col-3 py-1 font-semibold">Version:</div>
        <div class="col-9 py-1">{{plugin.version}}</div>

        <div class="col-3 py-1 font-semibold">Author:</div>
        <div class="col-9 py-1">{{plugin.author || "N/A"}}</div>

        <div class="col-3 py-1 font-semibold">Institution:</div>
        <div class="col-9 py-1">{{plugin.institution || "N/A"}}</div>

        <div class="col-3 py-1 font-semibold">Repository:</div>
        <div class="col-9 py-1">
          <div *ngIf="plugin.repository; else notApplicable">
            <a href={{plugin.repository}}>
              {{plugin.repository}}
            </a>
          </div>
        </div>

        <div class="col-3 py-1 font-semibold">Website:</div>
        <div class="col-9 py-1">
          <div *ngIf="plugin.website; else notApplicable">
            <a href={{plugin.website}}>
              {{plugin.website}}
            </a>
          </div>
        </div>

        <div class="col-3 py-1 font-semibold">Citation:</div>
        <div class="col-9 py-1">{{plugin.citation || "N/A"}}</div>

        <div class="col-3 py-1 font-semibold">Description:</div>
        <div class="col-9 py-1">{{plugin.description || "N/A"}}</div>

        <div class="col-3 py-1 font-semibold">Container images:</div>
        <div class="col-9 py-1">{{plugin.containerId || "N/A"}}</div>

        <div class="col-3 py-1 font-semibold">Base command:</div>
        <div class="col-9 py-1">{{plugin.baseCommand || "N/A"}}</div>

        <div class="col-3 py-1 font-semibold">Registration date:</div>
        <div class="col-9 py-1">{{plugin.creationDate | date}}</div>

      </div>
    </div>
  </div>
</p-fieldset>

<h2>Inputs</h2>

<p-table [value]="plugin.inputs" dataKey="name">
  <ng-template pTemplate="header">
    <tr>
      <th style="width: 5rem"></th>
      <th>Name</th>
      <th>Description</th>
      <th>Type</th>
      <th>Required</th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-input let-expanded="expanded">
    <tr>
      <td>
        <p-button type="button" pRipple [pRowToggler]="input" [text]="true" [rounded]="true" [plain]="true"
                  [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'" />
      </td>
      <td>{{ input.name }}</td>
      <td>{{ input.description || 'N/A' }}</td>
      <td>{{ input.type }}</td>
      <td>{{ input.required }}</td>
    </tr>
  </ng-template>
  <ng-template pTemplate="rowexpansion" let-input>
    <tr>
      <td colspan="5">
        <div class="p-3 grid">
          <div class="input-description-title col-2 lg:col-1">
            UI:
          </div>
          <div class="input-description col-10 lg:col-6">
            <ngx-json-viewer [json]="getInputUi(input.name) || {}"></ngx-json-viewer>
          </div>
          <div class="input-description-title col-2 lg:col-1">
            Options:
          </div>
          <div class="input-description col-10 lg:col-4">
            <ngx-json-viewer *ngIf="input.options" [json]="input.options" [expanded]="true"></ngx-json-viewer>
            <span *ngIf="!input.options">N/A</span>
          </div>
        </div>
      </td>
    </tr>
  </ng-template>
</p-table>

<h2>Outputs</h2>
<p-table [value]="plugin.outputs">
  <ng-template pTemplate="header">
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Type</th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-output>
    <tr>
      <td>{{ output.name }}</td>
      <td>{{ output.description }}</td>
      <td>{{ output.type }}</td>
    </tr>
  </ng-template>
</p-table>

<h2>Hardware Requirements</h2>
<p-table [value]="resourceRequirements">
  <ng-template pTemplate="header">
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Value</th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-req>
    <tr>
      <td>{{ req.name }}</td>
      <td>{{ req.description }}</td>
      <td>{{ req.value }}</td>
    </tr>
  </ng-template>
</p-table>

<p-dialog header="Plugin Manifest" [modal]="true" [(visible)]="showManifest"
          [style]="{ width: '50rem' }" >
  <div>
    <pre>{{ manifest | json }}</pre>
  </div>
</p-dialog>

<p-confirmDialog />

<ng-template #notApplicable>N/A</ng-template>